<!-- 主题切换组件 - 基于色彩心理学的疗愈主题 -->
<view class="theme-switcher-container {{isVisible ? 'visible' : ''}} {{currentTheme}}" wx:if="{{showThemeSwitcher}}">
  <!-- 功能按钮组 -->
  <view class="function-buttons">
    <!-- 主题切换按钮 -->
    <view class="theme-toggle-btn" bindtap="toggleThemeSwitcher">
      <text class="theme-text">主题</text>
    </view>
    
    <!-- 播放器按钮 -->
    <view class="player-toggle-btn" bindtap="togglePlayer">
      <text class="player-text">播放器</text>
    </view>
  </view>

  <!-- 主题选项面板 -->
  <view class="theme-panel {{isPanelVisible ? 'show' : ''}}">
    <view class="panel-header">
      <text class="panel-title">选择您的疗愈配色</text>
      <text class="panel-subtitle">基于色彩心理学的专业配色</text>
    </view>

    <view class="theme-options">
      <!-- 默认主题（映射到平静模式） -->
      <view 
        class="theme-option {{currentTheme === 'calm-mode' ? 'active' : ''}}"
        data-theme="calm-mode"
        bindtap="switchTheme"
      >
        <view class="theme-preview calm-preview">
          <view class="preview-color" style="background: #E0F2F1;"></view>
          <view class="preview-color" style="background: #14B8A6;"></view>
          <view class="preview-color" style="background: #10B981;"></view>
        </view>
        <view class="theme-info">
          <text class="theme-name">🌸 默认主题（平静）</text>
          <text class="theme-desc">蓝绿色调，降低心率</text>
        </view>
      </view>

      <!-- 平静模式 -->
      <view 
        class="theme-option {{currentTheme === 'calm-mode' ? 'active' : ''}}"
        data-theme="calm-mode"
        bindtap="switchTheme"
      >
        <view class="theme-preview calm-preview">
          <view class="preview-color" style="background: #E0F2F1;"></view>
          <view class="preview-color" style="background: #14B8A6;"></view>
          <view class="preview-color" style="background: #10B981;"></view>
        </view>
        <view class="theme-info">
          <text class="theme-name">🧘 平静模式</text>
          <text class="theme-desc">蓝绿色调，降低心率</text>
        </view>
      </view>

      

      <!-- 活力模式 -->
      <view 
        class="theme-option {{currentTheme === 'energy-mode' ? 'active' : ''}}"
        data-theme="energy-mode"
        bindtap="switchTheme"
      >
        <view class="theme-preview energy-preview">
          <view class="preview-color" style="background: #FFF4E6;"></view>
          <view class="preview-color" style="background: #EA580C;"></view>
          <view class="preview-color" style="background: #F97316;"></view>
        </view>
        <view class="theme-info">
          <text class="theme-name">⚡ 活力模式</text>
          <text class="theme-desc">暖橙色调，激发活力</text>
        </view>
      </view>

      <!-- 专注模式（映射 evening-theme） -->
      <view 
        class="theme-option {{currentTheme === 'evening-theme' ? 'active' : ''}}"
        data-theme="evening-theme"
        bindtap="switchTheme"
      >
        <view class="theme-preview focus-preview">
          <view class="preview-color" style="background: #E0E7FF;"></view>
          <view class="preview-color" style="background: #3730A3;"></view>
          <view class="preview-color" style="background: #A5B4FC;"></view>
        </view>
        <view class="theme-info">
          <text class="theme-name">🎯 专注模式</text>
          <text class="theme-desc">深紫色调，提升注意力</text>
        </view>
      </view>

      
    </view>

    

    <!-- 智能推荐（开关） -->
    <view class="smart-recommendation">
      <view class="recommendation-header">
        <text class="recommendation-icon">🤖</text>
        <text class="recommendation-title">智能推荐</text>
      </view>
      <view class="recommendation-row">
        <text class="recommendation-text">自动根据时间与使用习惯切换主题</text>
        <switch checked="{{autoRecommend}}" bindchange="onAutoRecommendChange" color="#FF6B35" />
      </view>
      <view wx:if="{{recommendedTheme}}" class="recommendation-hint">当前推荐：{{recommendedTheme.name}}</view>
    </view>
  </view>

  <!-- 背景遮罩 -->
  <view 
    class="theme-overlay {{isPanelVisible ? 'show' : ''}}" 
    bindtap="closeThemePanel"
  ></view>
</view>
