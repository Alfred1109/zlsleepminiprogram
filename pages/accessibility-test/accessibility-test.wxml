<!-- 可访问性测试页面 -->
<view class="accessibility-test-container">
  <!-- 页面标题 -->
  <view class="page-header">
    <text class="page-title">🔍 可访问性测试</text>
    <text class="page-subtitle">基于WCAG 2.1标准的色彩对比度测试</text>
  </view>

  <!-- 测试控制面板 -->
  <view class="control-panel">
    <button class="btn btn-brand" bindtap="runFullTest">
      {{isRunning ? '测试中...' : '开始全面测试'}}
    </button>
    <button class="btn btn-secondary" bindtap="generateReport">生成报告</button>
    <button class="btn btn-outline" bindtap="exportResults">导出结果</button>
  </view>

  <!-- 测试结果概览 -->
  <view class="results-overview" wx:if="{{testResults}}">
    <view class="overview-card">
      <text class="overview-title">测试结果概览</text>
      <view class="stats-grid">
        <view class="stat-item">
          <text class="stat-number">{{testResults.summary.total}}</text>
          <text class="stat-label">总测试项</text>
        </view>
        <view class="stat-item success">
          <text class="stat-number">{{testResults.summary.passed}}</text>
          <text class="stat-label">通过项</text>
        </view>
        <view class="stat-item error" wx:if="{{testResults.summary.failed > 0}}">
          <text class="stat-number">{{testResults.summary.failed}}</text>
          <text class="stat-label">失败项</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{testResults.summary.passRate}}%</text>
          <text class="stat-label">通过率</text>
        </view>
      </view>
      
      <!-- 通过率进度条 -->
      <view class="progress-container">
        <text class="progress-label">整体通过率</text>
        <view class="progress-bar">
          <view 
            class="progress-fill {{testResults.summary.passRate >= 90 ? 'success' : testResults.summary.passRate >= 70 ? 'warning' : 'error'}}"
            style="width: {{testResults.summary.passRate}}%;"
          ></view>
        </view>
        <text class="progress-text">{{testResults.summary.passRate}}%</text>
      </view>
    </view>
  </view>

  <!-- 详细测试结果 -->
  <view class="detailed-results" wx:if="{{testResults && testResults.details}}">
    <text class="section-title">📋 详细测试结果</text>
    
    <view class="test-results-list">
      <view 
        class="test-result-item {{item.passed ? 'passed' : 'failed'}}"
        wx:for="{{testResults.details}}"
        wx:key="index"
      >
        <!-- 测试状态图标 -->
        <view class="result-icon">
          <text class="icon">{{item.passed ? '✅' : '❌'}}</text>
        </view>
        
        <!-- 测试信息 -->
        <view class="result-info">
          <text class="test-description">{{item.description}}</text>
          <view class="color-preview">
            <view 
              class="color-sample"
              style="color: {{item.foreground}}; background-color: {{item.background}};"
            >
              示例文字 Sample Text
            </view>
          </view>
          <view class="test-metrics">
            <text class="metric">对比度: {{item.ratio}}:1</text>
            <text class="level-badge level-{{item.level}}">{{item.level}}</text>
          </view>
          <text class="recommendation">{{item.recommendation}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 改进建议 -->
  <view class="recommendations" wx:if="{{testResults && testResults.recommendations}}">
    <text class="section-title">💡 改进建议</text>
    <view class="recommendations-list">
      <view 
        class="recommendation-item"
        wx:for="{{testResults.recommendations}}"
        wx:key="index"
      >
        <text class="recommendation-text">{{item}}</text>
      </view>
    </view>
  </view>

  <!-- 自定义测试区域 -->
  <view class="custom-test">
    <text class="section-title">🎨 自定义颜色测试</text>
    <view class="custom-test-form">
      <view class="input-group">
        <text class="input-label">前景色 (文字颜色)</text>
        <input 
          class="color-input" 
          type="text" 
          placeholder="#1F2937" 
          value="{{customForeground}}"
          bindinput="onForegroundChange"
        />
      </view>
      <view class="input-group">
        <text class="input-label">背景色</text>
        <input 
          class="color-input" 
          type="text" 
          placeholder="#FFFFFF" 
          value="{{customBackground}}"
          bindinput="onBackgroundChange"
        />
      </view>
      <button class="btn btn-info" bindtap="testCustomColors">测试组合</button>
    </view>
    
    <!-- 自定义测试结果 -->
    <view class="custom-result" wx:if="{{customTestResult}}">
      <view class="custom-preview">
        <view 
          class="custom-sample"
          style="color: {{customForeground}}; background-color: {{customBackground}};"
        >
          这是测试文字样例
        </view>
      </view>
      <view class="custom-metrics">
        <text class="custom-ratio">对比度: {{customTestResult.ratio}}:1</text>
        <text class="custom-level level-{{customTestResult.level}}">{{customTestResult.level}}</text>
        <text class="custom-recommendation">{{customTestResult.recommendation}}</text>
      </view>
    </view>
  </view>

  <!-- WCAG标准说明 -->
  <view class="wcag-standards">
    <text class="section-title">📚 WCAG 2.1 标准说明</text>
    <view class="standards-grid">
      <view class="standard-item">
        <view class="standard-level level-AAA">AAA</view>
        <view class="standard-info">
          <text class="standard-name">AAA级 - 增强</text>
          <text class="standard-desc">普通文字: 7:1, 大文字: 4.5:1</text>
        </view>
      </view>
      <view class="standard-item">
        <view class="standard-level level-AA">AA</view>
        <view class="standard-info">
          <text class="standard-name">AA级 - 标准</text>
          <text class="standard-desc">普通文字: 4.5:1, 大文字: 3:1</text>
        </view>
      </view>
      <view class="standard-item">
        <view class="standard-level level-FAIL">FAIL</view>
        <view class="standard-info">
          <text class="standard-name">不达标</text>
          <text class="standard-desc">对比度不足，影响可读性</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 颜色理论说明 -->
  <view class="color-theory">
    <text class="section-title">🎭 色彩心理学在疗愈应用中的作用</text>
    <view class="theory-cards">
      <view class="theory-card">
        <text class="theory-title">🧘 平静色调</text>
        <text class="theory-desc">蓝绿色系有助于降低心率，促进放松和冥想状态</text>
      </view>
      <view class="theory-card">
        <text class="theory-title">🔥 活力色调</text>
        <text class="theory-desc">暖橙色系能激发多巴胺分泌，提升积极情绪和创造力</text>
      </view>
      <view class="theory-card">
        <text class="theory-title">🌿 治愈色调</text>
        <text class="theory-desc">自然绿色系激活副交感神经，有助于压力缓解和康复</text>
      </view>
    </view>
  </view>
</view>
